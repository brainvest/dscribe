<h1 mat-dialog-title>{{data.isNew ? 'New' : 'Edit'}} Property</h1>

<mat-dialog-content>
	<form #entityForm="ngForm">

		<mat-form-field class="full-width" appearance="outline">
			<mat-label>Name</mat-label>
			<input matInput type="text" placeholder="Name" name="name"
						 [(ngModel)]="property.name">
		</mat-form-field>

		<mat-form-field class="full-width" appearance="outline">
			<mat-label>Title</mat-label>
			<input matInput type="text" placeholder="Title" name="title"
						 [(ngModel)]="property.title">
		</mat-form-field>

		<mat-form-field class="full-width" appearance="outline">
			<mat-label>Data Type</mat-label>
			<mat-select name="dataType" placeholder="Data Type"
									[(ngModel)]="property.dataTypeId">
				<mat-option *ngFor="let dataType of data.basicInfo.dataTypes" [value]="dataType.id">
					{{dataType.name}}
				</mat-option>
			</mat-select>
		</mat-form-field>

		<mat-form-field class="full-width" *ngIf="isNavigation" appearance="outline">
			<mat-label>Data Type Entity</mat-label>
			<mat-select name="dataTypeEntity" placeholder="Data Type Entity"
									[(ngModel)]="property.dataTypeEntityId">
				<mat-option *ngFor="let entity of entities" [value]="entity.id">
					{{entity.name}}
				</mat-option>
			</mat-select>
		</mat-form-field>

		<div class="form-group" *ngIf="isNavigationProperty">
			<mat-form-field class="full-width" appearance="outline">
				<mat-label>Foreign Key Action</mat-label>
				<mat-select name="foreignKeyAction" placeholder="Foreign Key Action"
										[(ngModel)]="property.foreignKeyAction">
					<mat-option *ngFor="let action of actions | keys" [value]="action.key">
						{{action.value}}
					</mat-option>
				</mat-select>
			</mat-form-field>

			<mat-form-field
				*ngIf="property.foreignKeyAction == actions.CreateNewByName || property.foreignKeyAction == actions.RenameExisting"
				class="full-width" appearance="outline">
				<mat-label>Foreign Key Name</mat-label>
				<input matInput type="text" placeholder="Foreign Key Name" name="foreignKeyName"
							 [(ngModel)]="property.newForeignKeyName">
			</mat-form-field>

			<mat-form-field *ngIf="property.foreignKeyAction == actions.ChooseExistingById"
											class="full-width" appearance="outline">
				<mat-label>Foreign Key</mat-label>
				<mat-select name="foreignKeyId" placeholder="Choose Foreign Key"
										[(ngModel)]="property.newForeignKeyId">
					<mat-option *ngFor="let prop of compatibleForeignKeys" [value]="prop.id">
						{{prop.name}}
					</mat-option>
				</mat-select>
			</mat-form-field>
		</div>

		<div class="form-group"  *ngIf="isNavigationProperty">
			<mat-form-field class="full-width" appearance="outline">

				<mat-label>Inverse Property Action</mat-label>
				<mat-select name="inversePropertyAction" placeholder="Inverse Property Action"
										[(ngModel)]="property.inversePropertyAction">
					<mat-option *ngFor="let action of actions | keys" [value]="action.key">
						{{action.value}}
					</mat-option>
				</mat-select>
			</mat-form-field>

			<mat-form-field
				*ngIf="property.inversePropertyAction === actions.CreateNewByName || property.inversePropertyAction == actions.RenameExisting"
				class="full-width" appearance="outline">
				<mat-label>Inverse Property Name</mat-label>
				<input matInput type="text" placeholder="Inverse Property Name" name="inversePropertyName"
							 [(ngModel)]="property.newInversePropertyName">
			</mat-form-field>

			<mat-form-field
				*ngIf="property.inversePropertyAction === actions.CreateNewByName || property.inversePropertyAction == actions.RenameExisting"
				class="full-width" appearance="outline">
				<mat-label>Inverse Property Title</mat-label>
				<input matInput type="text" placeholder="Inverse Property Title" name="inversePropertyTitle"
							 [(ngModel)]="property.newInversePropertyTitle">
			</mat-form-field>

			<mat-form-field *ngIf="property.inversePropertyAction == actions.ChooseExistingById"
											class="full-width" appearance="outline">
				<mat-label>Inverse Property</mat-label>
				<mat-select name="inversePropertyId" placeholder="Choose Inverse Property"
										[(ngModel)]="property.newInversePropertyId">
					<mat-option *ngFor="let prop of compatibleInverseProperties" [value]="prop.id">
						{{prop.name}}
					</mat-option>
				</mat-select>
			</mat-form-field>
		</div>

		<mat-form-field class="full-width" appearance="outline">
			<mat-label>General Usage Category</mat-label>
			<mat-select name="usage" placeholder="General Usage Category"
									[(ngModel)]="property.propertyGeneralUsageCategoryId">
				<mat-option *ngFor="let category of data.basicInfo.propertyGeneralUsageCategories" [value]="category.id">
					{{category.name}}
				</mat-option>
			</mat-select>
		</mat-form-field>

		<mat-checkbox name="isNullable" [(ngModel)]="property.isNullable">Is Nullable</mat-checkbox>

	</form>

</mat-dialog-content>

<mat-dialog-actions>
	<button mat-icon-button (click)="save()">
		<mat-icon color="primary">save</mat-icon>
	</button>
	<button mat-icon-button (click)="cancel()">
		<mat-icon color="warn">cancel</mat-icon>
	</button>
</mat-dialog-actions>
